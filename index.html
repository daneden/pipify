<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PIPify: Picture-in-picture Bookmarklet</title>
    <link rel="stylesheet" href="./style.css" />
    <meta name="viewport" content="width=device-width" />
  </head>
  <body>
    <main>
      <section>
        <h1 class="center">PIPify: One-Click Picture-In-Picture</h1>
        <p class="center">
          Drag the “PIPify” link below into your bookmarks bar:
        </p>
        <p class="center">
          <a
            class="bookmarklet"
            href="javascript:(function()%7Bif(!('pictureInPictureEnabled'%20in%20document))%20%7Balert(%22Browser%20does%20not%20support%20picture-in-picture%22)%3Breturn%7Dconst%20firstVideo%20%3D%20document.querySelector('video')%3Bif(firstVideo%20%3D%3D%20null)%20%7Balert(%22No%20video%20element%20found%22)%3Breturn%7DfirstVideo.requestPictureInPicture()%7D)()"
            >PIPify</a
          >
        </p>
        <p>
          Then, on any page with a <code>&lt;video&gt;</code> element, click it
          to have the video appear on top of any windows; perfect for seeing
          video call participants while you're taking notes in a different
          application.
        </p>

        <p class="support"></p>
      </section>
      <section>
        <h2>Try it out</h2>
        <p>Try clicking “PIPify” above to see it in action.</p>
        <video controls preload="metadata" loop>
          <source type="video/mp4" src="./sample.mp4" />
          <p class="support">HTML video is not supported in this browser</p>
        </video>

        <small
          >Courtesy notice: the video above is 3.5mb in size. Clicking “PIPify”
          will download and play it.</small
        >
      </section>
      <section>
        <h2>How does it work?</h2>
        <p>
          This bookmarklet runs a simple JavaScript function that is essentially
          the following:
        </p>
        <pre>document.querySelector('video').requestPictureInPicture()</pre>
        <p>
          It leverages the browser's native “picture-in-picture” functionality
          to display playing video on top of other windows. You can read more
          about this behaviour in the
          <a href="https://www.w3.org/TR/picture-in-picture/"
            >W3C specification</a
          >
          for it.
        </p>
      </section>
    </main>
    <script type="text/javascript">
      const pipifyLink = document.querySelector(".bookmarklet")
      const demoVideo = document.querySelector("video")
      pipifyLink.addEventListener("click", () => {
        demoVideo.play()
      })
      const supportP = document.querySelector(".support")
      if (!("pictureInPictureEnabled" in document)) {
        supportP.innerHTML =
          "This browser does not support native picture-in-picture; the bookmarklet won't have any effect!"
      }
    </script>
  </body>
</html>
